<html>
    <div>
        <canvas id='myChart'></canvas>
    </div>
    <script src='https://cdn.jsdelivr.net/npm/chart.js'></script>
    <!--- <script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script>
        fetch('http://127.0.0.1:5000/analyze?ticker=msft')
    .then(response => response.json())
    .then(data => render_graph(data));
    </script>
    <script>
        const render_graph = data => {
            const currentData = data['stats']['Open'];
            // console.log(currentData);
            let xVals = Object.getOwnPropertyNames(currentData);
            xVals = xVals.map(Number);
            let yVals = Object.values(currentData);
            const ctx = document.getElementById('myChart');
            console.log(xVals[0]);
            console.log(yVals[0]);

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Date',
                        data: xVals,
                        borderColor: 'rgb(75, 192, 192)',
                        borderWidth: 1,
                    }],
                    datasets: [{
                        label: 'Opening Price',
                        data: yVals,
                        borderColor: 'rgb(75, 192, 0)',
                        borderWidth: 1,
                    }]
                },
                options: {
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'MSFT',
                    }

                }
            })
        }
    </script>
</html>
